{{#section 'title'}}
Giỏ hàng
{{/section}}

{{#section 'css'}}
<link rel="stylesheet" href="/assets/home/css/products.css">
<link rel="stylesheet" href="/assets/home/css/product-detail.css">
<style type="text/css">
table.shopping-cart td{
	vertical-align: middle;
}
</style>
{{/section}}

{{#section 'js'}}
<script src="/assets/home/js/products.js"></script>
<script type="text/javascript">
$('.removeItem').on('click', function() {
	var id = $(this).data('proid');
	$('#frmRemoveItem #txtP').val(id);
	$('#frmRemoveItem').submit();
});
$('.addByOne').on('click', function() {
	var quantity = $('#numItems');
	if(quantity && parseInt(quantity[0].value) < 10){
		quantity[0].value = parseInt(quantity[0].value) + 1;
	}
	var id = $(this).data('proid');
	$('#frmGetAmount #txtP').val(id);
	$('#txtQ').val(quantity[0].value);
	$('#frmGetAmount').submit();
});
$('.subByOne').on('click', function() {
	var quantity = $('#numItems');
	if(quantity && parseInt(quantity[0].value) < 10){
		quantity[0].value = parseInt(quantity[0].value) - 1;
	}
	var id = $(this).data('proid');
	$('#frmGetAmount #txtP').val(id);
	$('#txtQ').val(quantity[0].value);
	$('#frmGetAmount').submit();
});

$('#payment').on('click', function() {
	$('#frmPayment #orderDate').val((new Date()).toISOString());
	$('#frmPayment').submit();
});
</script>
{{/section}}

<form id="frmRemoveItem" method="POST" action="">
	<input type="hidden" value="removeFromCart" name="typeSubmit">
	<input type="hidden" name="proId" id="txtP">
</form>

<form id="frmGetAmount" method="POST" action="">
	<input type="hidden" value="getAmount" name="typeSubmit">
	<input type="hidden" name="proId" id="txtP">
	<input type="hidden" name="quantity" id="txtQ">
</form>

<form id="frmGetAmount" method="POST" action="">
	<input type="hidden" value="getAmount" name="typeSubmit">
	<input type="hidden" name="proId" id="txtP">
	<input type="hidden" name="quantity" id="txtQ">
</form>

<form id="frmPayment" method="POST" action="">
	<input type="hidden" value="payment" name="typeSubmit">
	<input type="hidden" id="orderDate" name="orderDate">
</form>

<div class="container">
	<div class="main">
		<div class="topPath row">
			<div class="col-lg-7">
				<span class="breadCum">
					<i class="fas fa-home"></i>
					<span class="breadCum-item">
						<a href="/"> ssgBackpack</a>
					</span>
					<span>/</span>
					<span class="breadCum-item active">Giỏ hàng</span>
				</span>
			</div>
			{{!-- <div class="col-lg-5">
				<span class="sortSel">
					<a href="#" class="active">Nổi bật</a>
					<span> / </span>
					<a href="#">Bán chạy</a>
					<span> / </span>
					<a href="#">Mới nhất</a>
				</span>
			</div> --}}
		</div>
		<div class="row">
			<div class="col-sm-2 col-md-2 col-lg-2">
				<div class="panel panel-default">
					<div class="panel-heading">
						<h3 class="panel-title">Nhà sản xuất</h3>
					</div>
					<div class="list-group">
						{{#each layoutVM.brands}}
						<a href="/product/byBra/{{BraID}}" class="list-group-item">{{BraName}}</a>
						{{/each}}
					</div>
				</div>
				<!-- End of panel Vendor -->
				<div class="panel panel-default">
					<div class="panel-heading">
						<h3 class="panel-title">Loại sản phẩm</h3>
					</div>
					<div class="list-group">
						{{#each layoutVM.categories}}
						<a href="/product/byCat/{{CatID}}" class="list-group-item">{{CatName}}</a>
						{{/each}}
					</div>
				</div>
				<!-- End of panel Types -->
			</div>

			<div class="col-sm-10 col-md-10 col-lg-10">
				<div class="container" id="cart" style="background-color:white">
					<table class="table table-hover shopping-cart">
						<thead>
							<tr>
								<th>&nbsp;</th>
								<th>Sản Phẩm</th>
								<th>Giá tiền</th>
								<th>Số lượng</th>
								<th>Thành tiền</th>
								<th>&nbsp;</th>
							</tr>
						</thead>
						<tbody>
							{{#each items}}
							<tr>
								<td>
									<img src="/imgs/products/{{product.ProID}}/1.jpg" height="185" width="185" style="max-height:100%; max-width:100%;">
								</td>
								<td>{{product.ProName}}</td>
								<td>{{number_format product.Price}}</td>
								<td>
									<a data-proid="{{product.ProID}}" class="btn btn-secondary btn-sm subByOne" href="javascript:;" role="button">
										<span aria-hidden="true">-</span>
									</a>
									<input type="number" name="quantity" id="numItems" value={{quantity}} min="1" max="10" style="border: none; width:30%; text-align:center" readonly>
									<a data-proid="{{product.ProID}}" class="btn btn-secondary btn-sm addByOne" href="javascript:;" role="button">
										<span aria-hidden="true">+</span>
									</a>
								</td>
								<td>{{number_format amount}}</td>
								<td class="text-right">
									<a data-proid="{{product.ProID}}" class="btn btn-danger removeItem" href="javascript:;" role="button">
										<span aria-hidden="true">&times;</span>
									</a>
								</td>
							</tr>
							{{/each}}
						</tbody>
						<tfoot>
							<tr>
								<td>&nbsp;</td>
								<td>&nbsp;</td>
								<td>&nbsp;</td>
								<td>&nbsp;</td>
								<td>Tổng tiền: {{number_format total}}</td>
								<td>&nbsp;</td>
							</tr>
							<tr>
								<td>&nbsp;</td>
								<td>&nbsp;</td>
								<td>&nbsp;</td>
								<td>&nbsp;</td>
								<!-- Hành động thanh toán chưa biết làm gì-->
								<td><button class="btn btn-primary" data-toggle="collapse" href="javascript:;" id="payment" role="button" aria-expanded="false" aria-controls="Payment">Thanh toán</button></td>
								<td>&nbsp;</td>
							</tr>
						</tfoot>
					</table>
				</div>
			</div>
		</div>
	</div>
</div>